<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="Official website for ICCV 2025 paper: Dataset Distillation with Feature Matching through the Wasserstein Metric">
  <meta property="og:title" content="Dataset Distillation with Feature Matching through the Wasserstein Metric"/>
  <meta property="og:description" content="Official website for ICCV 2025 paper: Dataset Distillation with Feature Matching through the Wasserstein Metric"/>
  <meta property="og:url" content="https://siquanhuang.github.io/Multi-metrics/"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/images/overview.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="Dataset Distillation with Feature Matching through the Wasserstein Metric">
  <meta name="twitter:description" content="Official website for ICCV 2025 paper: Dataset Distillation with Feature Matching through the Wasserstein Metric">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/overview.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="Federated learning, Backdoor attack, Distance-based defense, Multi-metrics">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- MathJax Configuration -->
  <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <title>Dataset Distillation with Feature Matching through the Wasserstein Metric</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Dataset Distillation with Feature Matching through the Wasserstein Metric</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Haoyang Liu</a><sup>1</sup>,</span>
                <span class="author-block">
                  <a href="https://williamium3000.github.io/" target="_blank">Yijiang Li</a><sup>2</sup>,</span>
                  <span class="author-block">
                    <a href="THIRD AUTHOR PERSONAL LINK" target="_blank">Tiancheng Xing</a></a><sup>3</sup>,</span>
                  </span>
                  <span class="author-block">
                    <a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Vibhu Dalal</a><sup>1</sup>,</span>
                  </span>
                  <span class="author-block">
                    <a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Luwei Li</a><sup>1</sup>,</span>
                  </span>
                  <span class="author-block">
                    <a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Jingrui He</a><sup>1</sup>,</span>
                  </span>
                  <span class="author-block">
                    <a href="FIRST AUTHOR PERSONAL LINK" target="_blank">Haohan Wang</a><sup>1</sup>,</span>
                  </span>


                  <div class="is-size-5 publication-authors">
                    <span class="author-block"><sup>1</sup>University of Illinois Urbana-Champaign, <sup>2</sup>UC San Diego, <sup>3</sup>Nanjing University<br>
                      <div class="column has-text-centered">
                        <span class="link-block">
                          <a href="https://iccv2025.thecvf.com/" target="_blank"
                             class="external-link button is-normal is-rounded"
                             style="background: linear-gradient(90deg, #185a9d 0%, #43cea2 100%); color: #fff; font-weight: 800; box-shadow: 0 8px 32px rgba(24,90,157,0.18); border: none; transition: all 0.25s cubic-bezier(.25,.8,.25,1); transform: translateY(-3px) scale(1.05); padding: 2.2em 2.6em; letter-spacing: 1.2px; backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px); border-radius: 2.5em;">
                            <span class="icon" style="margin-right: 10px;">
                              <i class="fas fa-trophy" style="color: #ffe066; font-size: 1.5em; text-shadow: 0 0 16px rgba(255,224,102,0.8), 0 0 4px #fff;"></i>
                            </span>
                            <span style="display:inline-block; vertical-align:middle;">
                              <span style="display:block; text-transform: uppercase; font-size: 1.08em; letter-spacing: 2px; color: #fff; text-shadow: 0 2px 10px rgba(24,90,157,0.18), 0 0 2px #43cea2;">
                                Accepted by
                              </span>
                              <span style="display:block; font-size:1.1em; font-weight:700; margin-top:0.15em; letter-spacing:1.5px; color:#ffe066; text-shadow: 0 2px 10px rgba(24,90,157,0.18), 0 0 2px #43cea2;">
                                ICCV 2025
                              </span>
                            </span>
                          </a>
                        </span>

                  <div class="column has-text-centered">
                    <div class="publication-links">

                      <span class="link-block">
                      <a href="https://liu-hy.github.io/WMDD/" target="_blank"
                      class="external-link button is-normal is-rounded is-bright">
                      <span class="icon">
                        <i class="fas fa-globe"></i>
                      </span>
                      <span>Website</span>
                    </a>
                  </span>
                  
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/abs/2311.18531" target="_blank"
                        class="external-link button is-normal is-rounded is-bright">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>
                    
                    <!-- Supplementary PDF link -->

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/Liu-Hy/WMDD" target="_blank"
                    class="external-link button is-normal is-rounded is-bright">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <!-- <span class="link-block">
                  <a href="static/pdfs/poster.pdf" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="fas fa-chalkboard-teacher"></i>
                  </span>
                  <span>Poster</span>
                </a>
              </span> -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <div style="display: flex; justify-content: center; align-items: center; gap: 2rem; flex-wrap: wrap;">
        <div style="flex: 1 1 300px; text-align: center;">
          <img src="static/images/distill_in1k.gif" alt="Distilled Images" style="max-width: 120%; height: auto; border-radius: 8px;"/>
          <div style="margin-top: 0.5rem; font-size: 1rem; color: #555;">Distilled Images on ImageNet-1k</div>
        </div>
        <div style="flex: 1 1 300px; text-align: center;">
          <img src="static/images/syn_img_gif.gif" alt="Distillation Process" style="max-width: 70%; height: auto; border-radius: 8px;"/>
          <div style="margin-top: 0.5rem; font-size: 1rem; color: #555;">Distillation Process</div>
        </div>
      </div>
      <h2 class="subtitle has-text-centered" style="margin-top: 2rem;">
        We introduce WMDD (Dataset Distillation with Wasserstein Metric-based Feature Matching) which employs the Wasserstein metric to enhance distribution matching.
      </h2>
    </div>
  </div>
</section>

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            Dataset Distillation (DD) aims to generate a compact synthetic dataset that enables models to achieve performance comparable to training on the full large dataset, significantly reducing computational costs. Drawing from optimal transport theory, we introduce WMDD (Dataset Distillation with Wasserstein Metric-based Feature Matching), a straightforward yet powerful method that employs the Wasserstein metric to enhance distribution matching.

We compute the Wasserstein barycenter of features from a pretrained classifier to capture essential characteristics of the original data distribution. By optimizing synthetic data to align with this barycenter in feature space and leveraging per-class BatchNorm statistics to preserve intra-class variations, WMDD maintains the efficiency of distribution matching approaches while achieving state-of-the-art results across various high-resolution datasets. Our extensive experiments demonstrate WMDD's effectiveness and adaptability, highlighting its potential for advancing machine learning applications at scale.
</p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->

<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Wasserstein Distance</h2>
          <div class="level-set has-text-justified">
            <p>
              <b>Wasserstein Distance:</b> For probability distributions <i>&mu;</i> and <i>&nu;</i> on a metric space &Omega; with distance metric D, the p-Wasserstein distance is defined as:
            </p>
            <p style="text-align: center;">
              <img src="https://latex.codecogs.com/svg.image?W_p(\mu,\nu)=\left(\inf_{\pi\in\Pi(\mu,\nu)}\int_{\Omega^2}D(x,y)^p\,d\pi(x,y)\right)^{1/p}" alt="Wasserstein Distance Equation" style="max-width: 100%; height: auto;"/>
            </p>
            <p>
              where $P(\Omega)$ represents the space of all distributions on $\Omega$. The collection $\Pi(\mu,\nu)$ contains all joint distributions $\pi$ on $\Omega \times \Omega$ with marginals $\mu$ and $\nu$. Intuitively, this distance measures the minimum ``work'' needed to transform $\mu$ into $\nu$, with the effort of moving each mass unit captured by the $p$-th power of distance $D$.
            </p>
            <p>
              <b>Wasserstein Barycenter:</b> Given N distributions $N$ distributions ${\nu_1,\dots,\nu_N} \in \mathbb{P} \subset P(\Omega)$, a Wasserstein barycenter solves:
            </p>
            <p style="text-align: center;">
              <img src="https://latex.codecogs.com/svg.image?\mu^*=\arg\min_{\mu}\frac{1}{N}\sum_{i=1}^N&nbsp;W_p^p(\mu,\nu_i)" alt="Wasserstein Barycenter Equation" style="max-width: 100%; height: auto;"/>
            </p>
            <p>
              where $\mathbb{P}$ represents a subset of distributions in $P(\Omega)$, and $W_p^p(\mu, \nu_i)$ denotes the $p$-Wasserstein distance (raised to power $p$) between $\mu$ and each distribution $\nu_i$. This formulation allows us to find a central, representative distribution that best summarizes a collection of distributions according to their geometric properties.
            </p>
          </div>
          <div style="display: flex; justify-content: center;">
            <img src="static/images/motivation.png" alt="gradient_feature" class="blend-img-background" style="max-width: 100%; height: auto;"/>
          </div>
          <br>
          <p>
            We demonstrate the ability of the Wasserstein barycenter to condense the core characteristics of distributions, and compare its effectiveness with KL divergence and Maximum Mean Discrepancy (MMD).
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">WMDD</h2>
          <p>
            We formulate dataset distillation as the problem of finding a synthetic empirical distribution $\mu_{\mathcal{S}}$—with learnable sample positions and weights—that minimizes the Wasserstein distance to the real data distribution $\mu_{\mathcal{T}}$:
          </p>
          <p style="text-align: center;">
            <img src="https://latex.codecogs.com/svg.image?\mu_{\mathcal{S}}^*=\arg\min_{\mu_{\mathcal{S}}\in\mathcal{P}_m}W_p^p(\mu_{\mathcal{S}},\mu_{\mathcal{T}})" alt="WMDD Objective" style="max-width: 100%; height: auto;"/>
          </p>
          <p>
            The optimization alternates between two steps: (1) updating the weights $\mathbf{w}$ by solving the dual of the optimal transport problem, and (2) updating the positions $\tilde{\mathbf{X}}$ using Newton’s method:
          </p>
          <p style="text-align: center;">
            <img src="https://latex.codecogs.com/svg.image?\tilde{\mathbf{x}}_j\leftarrow\tilde{\mathbf{x}}_j-\frac{1}{w_j}\sum_{i=1}^n&nbsp;t_{ij}(\tilde{\mathbf{x}}_j-\mathbf{x}_i)" alt="WMDD Update Rule" style="max-width: 100%; height: auto;"/>
          </p>
          <p>
            This iterative approach efficiently computes a Wasserstein barycenter, allowing the distilled (synthetic) dataset to closely match the structure and diversity of the original data.
          </p>
          <div style="display: flex; justify-content: center;">
            <img src="static/images/overview.png" alt="Method Overview" style="max-width: 100%; height: auto;"/>
          </div>
          <br>
          <p>
            Overall, real dataset $T$ and synthetic dataset $S$ pass through the feature network $f$ to obtain features. The features of the real dataset are used to compute the Wasserstein Barycenter. The synthetic dataset is optimized via feature matching and loss computation (combining feature loss and BN regularization) to align with the Barycenter, generating high-quality synthetic data for efficient model training.
          </p>
          
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Comparison with Prior Methods</h2>
          <p>
            WMDD consistently showed SOTA performance in most settings across different datasets.
          </p>
          <div style="display: flex; justify-content: center;">
            <figure style="text-align: center;">
              <img src="static/images/p_table.png" alt="Performance Table" style="max-width: 100%; height: auto;"/>
              <figcaption style="font-size: 0.95em; margin-top: 0.5em;">
                Performance comparison of various dataset distillation methods on different datasets.
              </figcaption>
            </figure>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Cross-architecture Generalization</h2>
          <p>
            Our synthetic data generalize well to other models in the ResNet family, and the performance increases with the model capacity in settings where the data size is relatively large.
          </p>
          <div style="display: flex; justify-content: center;">
            <figure style="text-align: center;">
              <img src="static/images/cross-arch.png" alt="Performance Table" style="max-width: 60%; height: auto;"/>
              <figcaption style="font-size: 0.95em; margin-top: 0.5em;">
                Cross-architecture generalization performance on Tiny-ImageNet and ImageNet-1K in different IPC settings.
              </figcaption>
            </figure>
          </div>
          
        </div>
      </div>
    </div>
  </div>
</section>

<section class="section hero is-small is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-full">
        <div class="content">
          <h2 class="title is-3">Ablation Study</h2>
         
          <div class="columns is-vcentered">
            <div class="column is-half" style="display: flex; flex-direction: column; align-items: center;">
              <figure style="text-align: center;">
                <img src="static/images/ablation1.png" alt="Ablation Study 1" style="max-width: 100%; height: auto;"/>
                <figcaption style="font-size: 0.95em; margin-top: 0.5em;">
                  Effect of Wasserstein Barycenter, compared with cross-entropy and MMD.
                </figcaption>
              </figure>
            </div>
            <div class="column is-half" style="display: flex; flex-direction: column; align-items: center;">
              <figure style="text-align: center;">
                <img src="static/images/ablation2.png" alt="Ablation Study 2" style="max-width: 100%; height: auto;"/>
                <figcaption style="font-size: 0.95em; margin-top: 0.5em;">
                  Effect of different $\lambda$.
                </figcaption>
              </figure>
            </div>
          </div>
  
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Paper poster -->
<!-- <section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title has-text-centered">Poster</h2>

      <iframe  src="static/pdfs/poster.pdf" width="100%" height="1000">
          </iframe>
        
      </div>
    </div>
  </section> -->
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title has-text-centered">Citation</h2>
      <p>If you find our work useful in your research, please consider citing:</p>
      <pre><code>@article{liu2023dataset,
    title={Dataset distillation via the wasserstein metric},
    author={Liu, Haoyang and Li, Yijiang and Xing, Tiancheng and Dalal, Vibhu and Li, Luwei and He, Jingrui and Wang, Haohan},
    journal={arXiv preprint arXiv:2311.18531},
    year={2023}
}</code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a> project page.
            You are free to borrow the source code of this website, we just ask that you link back to this page in the footer. <br> This website is licensed under a <a rel="license"  href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
